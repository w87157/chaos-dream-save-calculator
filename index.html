<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>卡厄斯夢境 存檔事件追蹤器</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body>
    <h1>卡厄斯夢境 存檔事件追蹤器</h1>
    <div class="subtitle">依照 TIER 與事件紀錄追蹤角色與卡牌變化與分數</div>

    <!-- 🔥 合併後的單一大 Panel（含 TIER + 角色狀態） -->
    <div class="role-section merged-panel">
      <div class="section-title-row merged">
        <div class="section-title">🎭 角色狀態</div>
      </div>

      <!-- TIER + 卡牌統計按鈕（同一行） -->
      <div class="tier-and-card-row">
        <div class="tier-input-row-wrapper">
          <label for="tierInput">存檔 TIER</label>
          <input id="tierInput" type="number" min="1" max="15" />
          <span class="tier-hint">影響總分上限：30 + 10 × (TIER - 1)</span>
        </div>

        <button
          type="button"
          id="cardStatsToggleAll"
          class="card-stats-toggle-all"
        >
          ▶ 卡牌數量統計
        </button>
      </div>

      <!-- 三角色橫排 -->
      <div class="role-progress-panel">
        <!-- 角色 1 -->
        <div class="role-progress-item" data-role="char1">
          <div class="role-progress-title">角色 1</div>

          <div class="progress-wrapper">
            <div class="progress-label" id="char1Label"></div>
            <div class="progress-bar">
              <div class="progress-fill" id="char1Fill"></div>
            </div>
          </div>

          <div class="score-label" id="char1Score">分數：0</div>

          <div class="card-stats-section collapsed" data-role="char1">
            <div class="card-stats-title">卡牌數量（角色 1）</div>

            <div class="card-stats-table">
              <div class="card-stats-header">
                <div class="card-stats-cell type">卡片種類</div>
                <div class="card-stats-cell">一般</div>
                <div class="card-stats-cell">普閃</div>
                <div class="card-stats-cell">神閃</div>
                <div class="card-stats-cell">移除</div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">角色卡</div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_character_normal">4</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_character_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_character_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_character_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">中立卡</div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_neutral_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_neutral_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_neutral_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_neutral_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">怪物卡</div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_monster_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_monster_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_monster_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_monster_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">禁忌卡</div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_forbidden_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_forbidden_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_forbidden_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char1_cardCount_forbidden_removed">0</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 角色 2 -->
        <div class="role-progress-item" data-role="char2">
          <div class="role-progress-title">角色 2</div>

          <div class="progress-wrapper">
            <div class="progress-label" id="char2Label"></div>
            <div class="progress-bar">
              <div class="progress-fill" id="char2Fill"></div>
            </div>
          </div>

          <div class="score-label" id="char2Score">分數：0</div>

          <div class="card-stats-section collapsed" data-role="char2">
            <div class="card-stats-title">卡牌數量（角色 2）</div>

            <div class="card-stats-table">
              <div class="card-stats-header">
                <div class="card-stats-cell type">卡片種類</div>
                <div class="card-stats-cell">一般</div>
                <div class="card-stats-cell">普閃</div>
                <div class="card-stats-cell">神閃</div>
                <div class="card-stats-cell">移除</div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">角色卡</div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_character_normal">4</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_character_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_character_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_character_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">中立卡</div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_neutral_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_neutral_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_neutral_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_neutral_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">怪物卡</div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_monster_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_monster_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_monster_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_monster_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">禁忌卡</div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_forbidden_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_forbidden_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_forbidden_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char2_cardCount_forbidden_removed">0</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 角色 3 -->
        <div class="role-progress-item" data-role="char3">
          <div class="role-progress-title">角色 3</div>

          <div class="progress-wrapper">
            <div class="progress-label" id="char3Label"></div>
            <div class="progress-bar">
              <div class="progress-fill" id="char3Fill"></div>
            </div>
          </div>

          <div class="score-label" id="char3Score">分數：0</div>

          <div class="card-stats-section collapsed" data-role="char3">
            <div class="card-stats-title">卡牌數量（角色 3）</div>

            <div class="card-stats-table">
              <div class="card-stats-header">
                <div class="card-stats-cell type">卡片種類</div>
                <div class="card-stats-cell">一般</div>
                <div class="card-stats-cell">普閃</div>
                <div class="card-stats-cell">神閃</div>
                <div class="card-stats-cell">移除</div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">角色卡</div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_character_normal">4</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_character_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_character_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_character_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">中立卡</div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_neutral_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_neutral_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_neutral_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_neutral_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">怪物卡</div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_monster_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_monster_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_monster_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_monster_removed">0</span>
                </div>
              </div>

              <div class="card-stats-row">
                <div class="card-stats-cell type">禁忌卡</div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_forbidden_normal">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_forbidden_foil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_forbidden_godfoil">0</span>
                </div>
                <div class="card-stats-cell">
                  <span id="char3_cardCount_forbidden_removed">0</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 你的事件輸入、紀錄、按鈕區塊（原樣保留） -->
    <div class="app-layout">
      <div class="left-panel">
        <div class="panel-section event-panel">
          <div class="section-title">📘 事件輸入</div>

          <!-- ① 事件 -->
          <div class="event-block">
            <div class="sub-title">① 事件</div>
            <div class="pill-group" data-group="eventType"></div>
          </div>

          <!-- ② / ③ 卡片區塊 -->
          <div class="card-block-wrapper">
            <div class="card-block transform-block">
              <div class="card-block-title">② 原卡片（轉化用）</div>

              <div class="card-block-row">
                <div class="card-block-label">卡片種類</div>
                <div class="pill-group" data-group="srcCardType"></div>
              </div>

              <div class="card-block-row">
                <div class="card-block-label">卡牌狀態</div>
                <div class="pill-group" data-group="srcFoilType"></div>
              </div>
            </div>

            <div class="card-block target-block">
              <div class="card-block-title">③ 目標卡片</div>

              <div class="card-block-row">
                <div class="card-block-label">卡片種類</div>
                <div class="pill-group" data-group="cardType"></div>
              </div>

              <div class="card-block-row">
                <div class="card-block-label">卡牌狀態</div>
                <div class="pill-group" data-group="foilType"></div>
              </div>
            </div>
          </div>

          <div class="action-row">
            <button id="confirmBtn" class="primary-btn">確定</button>
            <button id="undoBtn" class="secondary-btn">還原</button>
            <button id="clearBtn" class="danger-btn">清空</button>
          </div>
        </div>
      </div>

      <div class="right-panel">
        <div class="right-header">
          <div class="right-title">事件紀錄（僅顯示目前選取角色）</div>
        </div>

        <div id="logList" class="log-list">
          <div class="log-empty">尚無記錄。</div>
        </div>
      </div>
    </div>

    <!-- 浮動儲存區 -->
    <div class="save-load-bar">
      <button type="button" id="saveBtn" class="save-btn">💾</button>
      <button type="button" id="loadBtn" class="load-btn">📂</button>
      <button type="button" id="clearSaveBtn" class="clear-save-btn">🧹</button>
      <span id="saveStatus" class="save-status"></span>
    </div>

    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/main.js"></script>
  </body>
</html>
